jQuery.extend(jQDatatel.flickrBadge = function () { function b() { $("#flickrBadge").removeClass("loading"); $.each(a.photoList, function (b, c) { $("#flickrBadge").append('<a href="' + c.full + '" data-gal="prettyPhoto[flickrBadge]"><img height="' + a.thumbSize + '" width="' + a.thumbSize + '" src="' + c.src + '" alt="' + c.title + '"/></a>') }); $("a[rel^='prettyPhoto']").prettyPhoto({ theme: a.lightbox }) } var a = new Object; a.key = $("#flickrBadge").attr("data-key"); a.lightbox = $("#flickrBadge").attr("data-lightbox"); a.thumbSize = $("#flickrBadge").attr("data-thumbSize"); a.thumbSize = parseInt(a.thumbSize) == a.thumbSize ? a.thumbSize : 75; a.photos = $("#flickrBadge").attr("data-photos") == "" || parseInt($("#flickrBadge").attr("data-photos")) != $("#flickrBadge").attr("data-photos") ? 9 : $("#flickrBadge").attr("data-photos"); a.tags = $("#flickrBadge").attr("data-tags") == undefined ? "" : "&tags=" + $("#flickrBadge").attr("data-tags"); a.tagMode = $("#flickrBadge").attr("data-tag-mode") == undefined ? "" : "&tag_mode=" + $("#flickrBadge").attr("data-tag-mode"); a.tagMode = a.tags != "" && a.tagMode == "" ? "&tag_mode=any" : a.tagMode; a.username = $("#flickrBadge").attr("data-username"); a.findByUsername = "https://api.flickr.com/services/rest/?method=flickr.people.findByUsername&jsoncallback=?&api_key=" + a.key + "&username=" + a.username + "&format=json&callback=?"; a.search = "https://api.flickr.com/services/rest/?method=flickr.photos.search&jsoncallback=?&api_key=" + a.key + "&format=json&callback=?"; a.getSizes = "https://api.flickr.com/services/rest/?method=flickr.photos.getSizes&jsoncallback=?&api_key=" + a.key + "&format=json&callback=?"; a.userId = ""; a.photoList = new Array; $("#flickrBadge").empty(); $("#flickrBadge").addClass("loading"); jQuery.getJSON(a.findByUsername, function (c) { a.userId = c.user.id; jQuery.getJSON(a.search + "&page=1&per_page=" + a.photos + "&user_id=" + a.userId + a.tags + a.tagMode, function (c) { $.each(c.photos.photo, function (d, e) { var f = e.id; var g = e.title; jQuery.getJSON(a.getSizes + "&photo_id=" + f, function (d) { $.each(d.sizes.size, function (a, b) { if (b.label == "Large Square") { sqImg = b.source } if (b.label == "Large") { lgImg = b.source } }); a.photoList.push(new Object({ src: sqImg, full: lgImg, title: g })); if (c.photos.photo.length == a.photoList.length) { b() } }) }) }) }) })

$(document).ready(function () { jQDatatel.flickrBadge(); });