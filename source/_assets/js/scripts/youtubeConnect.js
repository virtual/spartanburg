(function(e){function t(e,n,r){function u(e,t){var n=e?window.addEventListener:window.removeEventListener;n?n("message",t,!1):(e?window.attachEvent:window.detachEvent)("onmessage",t)}if(window.jQuery&&e instanceof jQuery)e=e.get(0).id;var i=document.getElementById(e);if(i&&i.tagName.toUpperCase()!="IFRAME"){i=i.getElementsByTagName("iframe")[0]}if(!t.queue)t.queue={};var s=t.queue[e],o=document.readyState=="complete";if(o&&!i){window.console&&console.log("callPlayer: Frame not found; id="+e);if(s)clearInterval(s.poller)}else if(n==="listening"){if(i&&i.contentWindow){n='{"event":"listening","id":'+JSON.stringify(""+e)+"}";i.contentWindow.postMessage(n,"*")}}else if(!o||i&&(!i.contentWindow||s&&!s.ready)){if(!s)s=t.queue[e]=[];s.push([n,r]);if(!("poller"in s)){s.poller=setInterval(function(){t(e,"listening")},250);u(1,function a(n){var r=JSON.parse(n.data);if(r&&r.id==e&&r.event=="onReady"){clearInterval(s.poller);s.ready=true;u(0,a);while(r=s.shift()){t(e,r[0],r[1])}}},false)}}else if(i&&i.contentWindow){if(n.call)return n();i.contentWindow.postMessage(JSON.stringify({event:"command",func:n,args:r||[],id:e}),"*")}}e.fn.youtubeConnect=function(t){var n,r,i;n=e.extend({},e.fn.youtubeConnect.defaults,t);return this.each(function(){i=e(this);r=e.extend({},n,i.data());e.fn.youtubeConnect.initialize(i,r)})};e.fn.youtubeConnect.defaults={username:"youtube",key:"AI39si74j-JTeaPRRZYmb3Yj6O3UwJdN3AQOV39rvyAjC8Qjbbihewv1vbGPR4ZnG5n0WUw1EY23mLKcrJ82LFyuwfZDEC7rpw",videos:10};e.fn.youtubeConnect.initialize=function(t,n){var r="https://gdata.youtube.com/feeds/api/users/"+n.username+"?v=2&alt=json&callback=?",i="https://gdata.youtube.com/feeds/api/videos?v=2&author="+n.username+"&max-results="+n.videos+"&orderby=published&alt=jsonc&callback=?";e.when(e.getJSON(r),e.getJSON(i)).done(function(r,i){if(e("#ytConnectHeader").length!=0){e.fn.youtubeConnect.buildHeader(t,r[0],n)}if(e("#ytConnectStage").length!=0){e.fn.youtubeConnect.buildPlayer(t,i[0],n)}if(e("#ytConnectFeed").length!=0){e.fn.youtubeConnect.buildFeed(t,i[0],n);e.fn.youtubeConnect.buildEvents[e("#ytConnectStage").length!=0?"shared":"modal"](t,i[0],n)}})};e.fn.youtubeConnect.buildHeader=function(e,t,n){var r,i;e.find(".profileImage").attr("src",t.entry.media$thumbnail.url);e.find(".username").attr("href","https://www.youtube.com/user/"+t.entry.author[0].name.$t).text(t.entry.author[0].name.$t);if(typeof t.entry.yt$aboutMe!="undefined"){r=t.entry.yt$aboutMe.$t.replace(/\n\r?/g,"<br />");i=/(\b(https?):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;r=r.replace(i,"<a href='$1'>$1</a>");e.find(".summary").html(r)}if(typeof t.entry.summary!="undefined"){r=t.entry.summary.$t.replace(/\n\r?/g,"<br />");i=/(\b(https?):\/\/[-A-Z0-9+&@#\/%?=~_|!:,.;]*[-A-Z0-9+&@#\/%=~_|])/ig;r=r.replace(i,"<a href='$1'>$1</a>");e.find(".summary").html(r)}};e.fn.youtubeConnect.buildFeed=function(t,n,r){var i,s,o,u,a;i=t.find(e(".itemTemplate")).clone().removeClass("itemTemplate");s=t.find(e(".itemTemplate")).parent();t.find(e(".itemTemplate")).remove();e.each(n.data.items,function(t,n){o=i.clone();o.find(".title").text(n.title);u=(parseInt(n.duration)%60).toString();u=u.length==1?"0"+u:u;o.find(".duration").text(Math.floor(parseInt(n.duration)/60).toString()+":"+u);o.find("img").attr("src",n.thumbnail.sqDefault.replace("http","https"));o.find(".uploadDate").text(e.fn.youtubeConnect.timeAgo(n.updated));a=n.viewCount!==undefined?e.fn.youtubeConnect.formatNumber(n.viewCount)+" views":"0 views";o.find(".views").text(a);s.append(o);if(t==r.videos-1){return false}});t.find("#ytConnectFeed .item:first").addClass("active")};e.fn.youtubeConnect.buildPlayer=function(t,n,r){t.find("#playerTitle").text(n.data.items[0].title);var i="https://www.youtube.com/embed/"+n.data.items[0].id+"?enablejsapi=1";e.getScript("/client/scripts/jquery.fitvids.min.js").done(function(n,r){t.find("#player iframe").eq(0).attr("src",i);e("#player").fitVids()})};e.fn.youtubeConnect.buildEvents={modal:function(t,n,r){t.find(".item").each(function(t){e(this).wrap('<a href="'+n.data.items[t].player["default"]+'" rel="prettyPhoto[youtubeBadge]" class="itemWrapper" />')});if(typeof e.prettyPhoto=="undefined"){e.getScript("/client/scripts/prettyphoto/js/jquery.prettyPhoto.js").done(function(e,n){t.find("a[rel^='prettyPhoto']").prettyPhoto()})}else{t.find("a[rel^='prettyPhoto']").prettyPhoto()}},shared:function(n,r,i){n.find(".item").each(function(i){e(this).click(function(){n.find(".item").removeClass("active");n.find("#playerTitle").text(r.data.items[i].title);t("player","cueVideoById",[r.data.items[i].id]);e(this).addClass("active")})})}};e.fn.youtubeConnect.formatNumber=function(e){var t,n,r,i;e+="";t=e.split(".");n=t[0];r=t.length>1?"."+t[1]:"";i=/(\d+)(\d{3})/;while(i.test(n)){n=n.replace(i,"$1"+","+"$2")}return n+r};e.fn.youtubeConnect.timeAgo=function(e){var t,n,r,i,s,o,u,a,f,l,c,h,p,d;t=new Date;e=e.substring(5,7)+"/"+e.substring(8,10)+"/"+e.substring(0,4)+" "+e.substring(11,13)+":"+e.substring(14,16);n=new Date(e);r=t-n;i=1e3;s=i*60;o=s*60;u=o*24;a=u*7;if(isNaN(r)||r<0){return""}if(r<i*2){return"right now"}if(r<s){return Math.floor(r/i)+" seconds ago"}if(r<s*2){return"about 1 minute ago"}if(r<o){return Math.floor(r/s)+" minutes ago"}if(r<o*2){return"about 1 hour ago"}if(r<u){return Math.floor(r/o)+" hours ago"}if(r>u&&r<u*2){return"yesterday"}else{f=["January","February","March","April","May","June","July","August","September","October","November","December"];l=n.getHours()>12?n.getHours()-11:n.getHours();c=n.getMinutes().toString().length<2?"0"+n.getMinutes().toString():n.getMinutes();h=f[n.getMonth()];d=n.getHours()>12?"PM":"AM";if(n.getDate()=="2"||n.getDate()=="22"){p=n.getDate()+"nd"}else if(n.getDate()=="3"||n.getDate()=="23"){p=n.getDate()+"rd"}else if(n.getDate()=="1"||n.getDate()=="21"||n.getDate()=="31"){p=n.getDate()+"st"}else{p=n.getDate()+"th"}return l+":"+c+" "+d+" "+h+" "+p}}})(jQuery);$(document).ready(function(){$(".ytConnect").youtubeConnect()})